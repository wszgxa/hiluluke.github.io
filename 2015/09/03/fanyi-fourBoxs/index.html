<!DOCTYPE html>
<html>
  <head>
    
    <title>如何创建一个平铺背景滑动效果【日常翻译五】 | hilu&#39;s note</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta charset="utf-8">
    <link rel="alternate" href="/atom.xml" title="hilu&#39;s note" type="application/atom+xml">
    
    <link rel="icon" href="/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.css">
  </head>
<body>
  <script type="text/javascript">
    // fix sidebar flashing
    (function(){
      if (localStorage.getItem('sidebarState') == 'true') {
        document.body.className="sideShow"
      }
    })()
  </script>
  <div id="container">
    <aside class="sidebar">
  <div class="head-icon">
  
    <a href="/about">
      <img src="/avatar.jpeg">
    </a>
  
  </div>
  <div class="name">hiluluke</div>
  <div class="desc">
    <h4>我是一个粉刷匠</h4>  
  </div>
  <nav class="side-nav">
    <div class="nav-item">
      <a href="/archives">
        <span>
          26
        </span>
        <span>日志</span>
      </a>
    </div>
    <div class="nav-item">
      <a href="/categories">
        <span>
          7
        </span>
        <span>分类</span>
      </a>
    </div>
    <div class="nav-item">
      <a href="/tags">
        <span>
          22
        </span>
        <span>标签</span>
      </a>
    </div>
  </nav>
  
  <div class="social-wrap">
    
    <a href="https://github.com/wszgxa" target="_blank">
      <div class="item">
        <i class="i-github"></i>
      </div>
    </a>
    
    <a href="http://v2ex.com/member/hiluluke" target="_blank">
      <div class="item">
        <i class="i-v2ex"></i>
      </div>
    </a>
    
    <a href="https://www.zhihu.com/people/zhao-guo-xu" target="_blank">
      <div class="item">
        <i class="i-zhihu"></i>
      </div>
    </a>
    
    <a href="https://twitter.com/Hiluluke" target="_blank">
      <div class="item">
        <i class="i-twitter"></i>
      </div>
    </a>
    
    <a href="http://codepen.io/hiluluke" target="_blank">
      <div class="item">
        <i class="i-codepen"></i>
      </div>
    </a>
    
  </div>
  
</aside>
    <div class="wrap">
      <div class="side">
  <div class="top" id="back-top"></div>
  <div class="arrows" id="nav-btn"></div>
</div>
      <header class="header">
  <div class="arrows" id="nav-btn"></div>
</header>
      <section id="main" class="content">
        
<section class="archives-wrap">
  <div class="archives">
    <div class="title-wrap">
      <h1>如何创建一个平铺背景滑动效果【日常翻译五】</h1>
      <div class="page-info">
      
        <span>By <a href="/about">Hilu Luke</a> on</span>
      
        <time datetime="2015-09-02T16:00:00.000Z" itemprop="datePublished">Sep 3 2015</time>
      </div>
    </div>
    <div class="content-wrap">
    <p>今天我们将看看如何实现像<a href="http://www.atelier-serge-thoraval.com/fr/" target="_blank" rel="external">Serge Thoroval’s Atelier</a>中的全屏背景滑动特效。<br><a href="http://tympanus.net/codrops/2015/03/04/playful-trampoline-effect/" target="_blank" rel="external">demo和原来译文</a></p>
<h2 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h2><p>为了达到这个滚动效果，我们需要一个能让我们构造4个不同“瓷砖”效果的特别标签结构，它们将使用同一张图片的不同部分。因为我们这是一个全屏滚动效果，所以我们需要确保让所有元素都延伸至全屏。为了使得我们能制定那个图片被可见，我们需要定义一个简单的初始结构并构建我们“瓷砖”的重复结构。初始结构就像这样：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"boxgallery"</span> <span class="attr">class</span>=<span class="string">"boxgallery"</span> <span class="attr">data-effect</span>=<span class="string">"effect-1"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/1.jpg"</span> <span class="attr">alt</span>=<span class="string">"Image 1"</span>/&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/2.jpg"</span> <span class="attr">alt</span>=<span class="string">"Image 2"</span>/&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/3.jpg"</span> <span class="attr">alt</span>=<span class="string">"Image 3"</span>/&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/4.jpg"</span> <span class="attr">alt</span>=<span class="string">"Image 4"</span>/&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>为了去将一张图片分成4个小瓷砖，我们为每个面板构建如下的重复结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"boxgallery"</span> <span class="attr">class</span>=<span class="string">"boxgallery"</span> <span class="attr">data-effect</span>=<span class="string">"effect-1"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel current"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-tile"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-img"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/1.jpg"</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-tile"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-img"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/1.jpg"</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-tile"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-img"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/1.jpg"</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-tile"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-img"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/1.jpg"</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-tile"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-img"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/2.jpg"</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-tile"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-img"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/2.jpg"</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-tile"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-img"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/2.jpg"</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-tile"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg-img"</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/2.jpg"</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- ... --&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- ... --&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">nav</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"prev"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"next"</span>&gt;</span><span class="tag">&lt;<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">nav</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<p>当然我们将会加上两个个按钮，这样浏览器才能实现动画。我们这里定义了data属性<code>data-effect</code>将会使我们定义一些不同的变化效果。</p>
<p>自然的，你会思考这个结构，然后你会问：为什么不使用background image 取代image元素？在尝试了很多次跨浏览器调试之后，我们得出了一个结论：在使用背景图片同时使用<code>background-size</code>    同时会导致波浪起伏的（掉帧）渐变效果。比如，当使用<code>background-size:cover</code>会导致动画效果抽搐。另外一个会导致抽搐渐变的是在执行渐变时使用百分比。第一眼看上去可能不会注意到，但是当使用像素的动画效果比较，你就会看到巨大的<a href="http://jsfiddle.net/crnacura/rmZ7B/5/" target="_blank" rel="external">差别</a>了。出于上述原因：我们将不再使用classes来控制动画变换，我们将用js脚本来控制视窗大小，并将相应的视窗大小用像素单位加在我们的瓷砖上。</p>
<p>接下来加入一些样式给他们。</p>
<h2 id="CSS部分"><a href="#CSS部分" class="headerlink" title="CSS部分"></a>CSS部分</h2><p>在我们脑中已经构建了一个结构，现在需要得是加入样式。</p>
<p>首先，我们是处于“全屏”模式，所以我们需要先让我们得页面元素准备好这。设置<code>html</code>和<code>body</code>和主要得conatiner高度为100%将会允许我们扩张我们得滚动效果为铺满全视口的：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">html</span>, <span class="selector-tag">body</span>, <span class="selector-class">.container</span> &#123;</div><div class="line">	<span class="attribute">height</span>: <span class="number">100%</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>主要得包含块和子块都赋予绝对定位，而面板将会占住所有得宽和高。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.js</span> <span class="selector-class">.boxgallery</span>,</div><div class="line"><span class="selector-class">.js</span> <span class="selector-class">.boxgallery</span> <span class="selector-tag">div</span> &#123;</div><div class="line">	<span class="attribute">position</span>: absolute;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.js</span> <span class="selector-class">.boxgallery</span>,</div><div class="line"><span class="selector-class">.js</span> <span class="selector-class">.panel</span> &#123;</div><div class="line">	<span class="attribute">top</span>: <span class="number">0</span>;</div><div class="line">	<span class="attribute">left</span>: <span class="number">0</span>;</div><div class="line">	<span class="attribute">width</span>: <span class="number">100%</span>;</div><div class="line">	<span class="attribute">height</span>: <span class="number">100%</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>因为所有的动画特效将可能导致元素溢出到限制之外，所以我们将确保没有任何东西溢出：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.js</span> <span class="selector-class">.boxgallery</span>,</div><div class="line"><span class="selector-class">.bg-tile</span>,</div><div class="line"><span class="selector-class">.bg-img</span> &#123;</div><div class="line">	<span class="attribute">overflow</span>: hidden;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当我们看Serge Thoroval的滚动特效时，你会发现在换屏动画的过程中，新显示的背景也会滑动进入。我们将会使用3D转换，所以我们需要设置透视（perspective）以使得我们能够在z轴能够对起产生的变换对我们可见：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.panel</span> &#123;</div><div class="line">	<span class="attribute">z-index</span>: <span class="number">0</span>;</div><div class="line">	<span class="attribute">perspective</span>: <span class="number">1200px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>接下来，我们需要给“瓷砖”片设置样式。因为我们需要4个瓷砖片，所以我们给每个都设置50%的高和宽。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.bg-tile</span> &#123;</div><div class="line">	<span class="attribute">width</span>: <span class="number">50%</span>;</div><div class="line">	<span class="attribute">height</span>: <span class="number">50%</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其他得“瓷片”：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(2)</span>,</div><div class="line"><span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(4)</span> &#123;</div><div class="line">	<span class="attribute">left</span>: <span class="number">50%</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(3)</span>,</div><div class="line"><span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(4)</span> &#123;</div><div class="line">	<span class="attribute">top</span>: <span class="number">50%</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>内部带有class为<strong>bg-img</strong>的图片将会填充整个瓷片:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.bg-img</span> &#123;</div><div class="line">	<span class="attribute">width</span>: <span class="number">100%</span>;</div><div class="line">	<span class="attribute">height</span>: <span class="number">100%</span>;</div><div class="line">	<span class="attribute">background</span>: <span class="number">#999</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>为了让每个瓷片的图片都完全展现整个屏幕，我们需要设置img的高度和宽度是原先的两倍。如果对高度和宽度都使用百分比，高度和和宽度会将我们得图片扭曲，所以我们需要确保方向比例。我们能够只设置其中一个尺寸为200%，而另外一个定义为自动调节。但是，我们设置哪个呢？这取决于视窗是更宽还是更高。幸运的是，我们可以使用媒体查询，然后恰恰有一个属性可以帮我们做这件事:min-aspect-ratio。这个属性允许我们拿图片真正的大小作为比例并定义，所以我们可以自动计算调整以什么为百分比：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.bg-img</span> <span class="selector-tag">img</span> &#123;</div><div class="line">	<span class="attribute">position</span>: absolute;</div><div class="line">	<span class="attribute">display</span>: block;</div><div class="line">	<span class="attribute">height</span>: <span class="number">200%</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@<span class="keyword">media</span> screen and (min-aspect-ratio: <span class="number">1280</span>/<span class="number">850</span>) &#123;</div><div class="line">	<span class="selector-class">.bg-img</span> <span class="selector-tag">img</span> &#123;</div><div class="line">		<span class="attribute">width</span>: <span class="number">200%</span>;</div><div class="line">		<span class="attribute">height</span>: auto;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>你能够使用上面的这个方法在其他需要调节图片与屏幕比例的地方。</p>
<p>每个图片都需要定位：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(2)</span> <span class="selector-class">.bg-img</span> <span class="selector-tag">img</span>,</div><div class="line"><span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(4)</span> <span class="selector-class">.bg-img</span> <span class="selector-tag">img</span> &#123;</div><div class="line">	<span class="attribute">left</span>: -<span class="number">100%</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(3)</span> <span class="selector-class">.bg-img</span> <span class="selector-tag">img</span>,</div><div class="line"><span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(4)</span> <span class="selector-class">.bg-img</span> <span class="selector-tag">img</span> &#123;</div><div class="line">	<span class="attribute">top</span>: -<span class="number">100%</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>两边的button箭头使用<a href="http://tympanus.net/Development/ArrowNavigationStyles/" target="_blank" rel="external">Arrow Navigation Styles</a>中的“Fill Path”样式。、</p>
<p>接下来，让我们定义当我们翻页（navigate）时发生什么？</p>
<p>首先，我们需要设置current panel的z-index，让它处于我们其他元素得上面。因为我们设置了所有得（panel）面板得z-index为0，所以我们能只用比如1的值。但是因为我们有一个active panel需要设置在current panel下面，所以我们设置z-index如下：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.panel</span><span class="selector-class">.current</span> &#123;</div><div class="line">	<span class="attribute">z-index</span>: <span class="number">2</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.panel</span><span class="selector-class">.active</span> &#123;</div><div class="line">	<span class="attribute">z-index</span>: <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这就能够保证current在所有元素上面，而新加入得元素在其下面。</p>
<p>鉴于我们要使用脚本控制每个带有“bg-img”的元素加入3D转换效果（之前我们提过，我们要用像素作为转换的参数，因此需要window的宽和高），我们任然需要设置一些东西在我们得样式表中，比如过渡效果和新panel的动画。</p>
<p>因此，让我们定义一个transition给我们的transform元素并带有过渡时间和松弛度得参数：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.panel</span><span class="selector-class">.current</span> <span class="selector-class">.bg-img</span> &#123;</div><div class="line">	<span class="attribute">transition</span>: transform <span class="number">1.1s</span> ease-in-out;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对于第一个特效（螺旋效果）和第二个（将瓷片移除到外部），我们想让起动画开始有一个按比例缩减得效果：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-1"]</span> <span class="selector-class">.panel</span><span class="selector-class">.active</span> <span class="selector-class">.bg-tile</span>,</div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-2"]</span> <span class="selector-class">.panel</span><span class="selector-class">.active</span> <span class="selector-class">.bg-tile</span> &#123;</div><div class="line">	<span class="attribute">animation</span>: scaleDown <span class="number">1.1s</span> ease-in-out;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@<span class="keyword">keyframes</span> scaleDown &#123;</div><div class="line">	<span class="selector-tag">from</span> &#123; <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(0,0,380px); &#125;</div><div class="line">	<span class="selector-tag">to</span> &#123; <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(0,0,0); &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们给每个瓷片的子元素加入了一点动画延迟，然后使用cubic-bezier让所有动画都快一点。这个变动将会使得“小瓷片”上下渐变消失时间不同：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* Variation 2 */</span></div><div class="line"></div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-2"]</span> <span class="selector-class">.panel</span><span class="selector-class">.current</span> <span class="selector-class">.bg-img</span> &#123;</div><div class="line">	<span class="attribute">transition</span>: transform <span class="number">0.9s</span> <span class="built_in">cubic-bezier</span>(0.7,0,0.3,1);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-2"]</span> <span class="selector-class">.panel</span><span class="selector-class">.current</span> <span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(2)</span> <span class="selector-class">.bg-img</span> &#123;</div><div class="line">	<span class="attribute">transition-delay</span>: <span class="number">0.15s</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-2"]</span> <span class="selector-class">.panel</span><span class="selector-class">.current</span> <span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(3)</span> <span class="selector-class">.bg-img</span> &#123;</div><div class="line">	<span class="attribute">transition-delay</span>: <span class="number">0.3s</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-2"]</span> <span class="selector-class">.panel</span><span class="selector-class">.current</span> <span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(4)</span> <span class="selector-class">.bg-img</span> &#123;</div><div class="line">	<span class="attribute">transition-delay</span>: <span class="number">0.45s</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>第三部分在新面板加入时使用一个覆盖层渐出达到模糊效果：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* Variation 3 */</span></div><div class="line"></div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-3"]</span> <span class="selector-class">.panel</span><span class="selector-pseudo">::after</span> &#123;</div><div class="line">	<span class="attribute">position</span>: absolute;</div><div class="line">	<span class="attribute">width</span>: <span class="number">100%</span>;</div><div class="line">	<span class="attribute">height</span>: <span class="number">100%</span>;</div><div class="line">	<span class="attribute">background</span>: <span class="built_in">rgba</span>(0,0,0,0.8);</div><div class="line">	<span class="attribute">content</span>: <span class="string">''</span>;</div><div class="line">	<span class="attribute">transition</span>: opacity <span class="number">1.1s</span> ease-in-out;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-3"]</span> <span class="selector-class">.panel</span><span class="selector-class">.current</span><span class="selector-pseudo">::after</span>,</div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-3"]</span> <span class="selector-class">.panel</span><span class="selector-class">.active</span><span class="selector-pseudo">::after</span> &#123;</div><div class="line">	<span class="attribute">opacity</span>: <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-3"]</span> <span class="selector-class">.panel</span><span class="selector-class">.current</span><span class="selector-pseudo">::after</span> &#123;</div><div class="line">	<span class="attribute">transition</span>: none;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们同时也使用cubic-bezier和延迟一些时间：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-3"]</span> <span class="selector-class">.panel</span><span class="selector-class">.current</span> <span class="selector-class">.bg-img</span> &#123;</div><div class="line">	<span class="attribute">transition</span>: transform <span class="number">1.1s</span> <span class="built_in">cubic-bezier</span>(0.7,0,0.3,1);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-3"]</span> <span class="selector-class">.panel</span><span class="selector-class">.current</span> <span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(2)</span> <span class="selector-class">.bg-img</span> &#123;</div><div class="line">	<span class="attribute">transition-delay</span>: <span class="number">0.15s</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-3"]</span> <span class="selector-class">.panel</span><span class="selector-class">.current</span> <span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(3)</span> <span class="selector-class">.bg-img</span> &#123;</div><div class="line">	<span class="attribute">transition-delay</span>: <span class="number">0.3s</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.boxgallery</span><span class="selector-attr">[data-effect="effect-3"]</span> <span class="selector-class">.panel</span><span class="selector-class">.current</span> <span class="selector-class">.bg-tile</span><span class="selector-pseudo">:nth-child(4)</span> <span class="selector-class">.bg-img</span> &#123;</div><div class="line">	<span class="attribute">transition-delay</span>: <span class="number">0.45s</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="JS部分"><a href="#JS部分" class="headerlink" title="JS部分"></a>JS部分</h2><p>就像之前提到过的，我们选择使用js来操作动画，目的是使用以像素宽高的动画。当然我们也可以选择在css中使用百分比为的动画，那样会更加方便，但是却使我们的动画抽搐。</p>
<p>首先看看这个定义函数。</p>
<p>我们首先开始定义我们将赋予panels滑动的变换动画。我们需要分别制定左右箭头的变换。让我们定义一个合适的<strong>setTransforms</strong>函数结构。</p>
<p>接下来，我们获取特效类别从<strong>data-effect</strong>属性。这个将指明我们调用文件是实现定义的哪个文件。</p>
<p>然后，我们初始化一些变量，然后创建一些四个盒子必要的DOM结构。对于那个，每个面板的图片被4个分割部分所替代，每个部分都有同样得src。我们同样加入前后箭头<code>nav</code>节点。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">BoxesFx.prototype._init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// set transforms configuration</span></div><div class="line">	<span class="keyword">this</span>._setTransforms();</div><div class="line">	<span class="comment">// which effect</span></div><div class="line">	<span class="keyword">this</span>.effect = <span class="keyword">this</span>.el.getAttribute( <span class="string">'data-effect'</span> ) || <span class="string">'effect-1'</span>;</div><div class="line">	<span class="comment">// check if animating</span></div><div class="line">	<span class="keyword">this</span>.isAnimating = <span class="literal">false</span>;</div><div class="line">	<span class="comment">// the panels</span></div><div class="line">	<span class="keyword">this</span>.panels = [].slice.call( <span class="keyword">this</span>.el.querySelectorAll( <span class="string">'.panel'</span> ) );</div><div class="line">	<span class="comment">// total number of panels (4 for this demo)</span></div><div class="line">	<span class="comment">//this.panelsCount = this.panels.length;</span></div><div class="line">	<span class="keyword">this</span>.panelsCount = <span class="number">4</span>;</div><div class="line">	<span class="comment">// current panel´s index</span></div><div class="line">	<span class="keyword">this</span>.current = <span class="number">0</span>;</div><div class="line">	classie.add( <span class="keyword">this</span>.panels[<span class="number">0</span>], <span class="string">'current'</span> );</div><div class="line">	<span class="comment">// replace image with 4 divs, each including the image</span></div><div class="line">	<span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">	<span class="keyword">this</span>.panels.forEach( <span class="function"><span class="keyword">function</span>(<span class="params"> panel </span>) </span>&#123;</div><div class="line">		<span class="keyword">var</span> img = panel.querySelector( <span class="string">'img'</span> ), imgReplacement = <span class="string">''</span>;</div><div class="line">		<span class="keyword">for</span>( <span class="keyword">var</span> i = <span class="number">0</span>; i &lt; self.panelsCount; ++i ) &#123;</div><div class="line">			imgReplacement += <span class="string">'&lt;div class="bg-tile"&gt;&lt;div class="bg-img"&gt;&lt;img src="'</span> + img.src + <span class="string">'" /&gt;&lt;/div&gt;&lt;/div&gt;'</span></div><div class="line">		&#125;</div><div class="line">		panel.removeChild( img );</div><div class="line">		panel.innerHTML = imgReplacement + panel.innerHTML;</div><div class="line">	&#125; );</div><div class="line">	<span class="comment">// add navigation element</span></div><div class="line">	<span class="keyword">this</span>.nav = <span class="built_in">document</span>.createElement( <span class="string">'nav'</span> );</div><div class="line">	<span class="keyword">this</span>.nav.innerHTML = <span class="string">'&lt;span class="prev"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;&lt;span class="next"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;'</span>;</div><div class="line">	<span class="keyword">this</span>.el.appendChild( <span class="keyword">this</span>.nav );</div><div class="line">	<span class="comment">// initialize events</span></div><div class="line">	<span class="keyword">this</span>._initEvents();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>动画中变化的变量是使用window得<code>width</code>和<code>height</code>。我们多加了10像素，这样动画变换就不会在最后可看见的部分结束，并使得其更加顺滑：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">BoxesFx.prototype._setTransforms = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">this</span>.transforms = &#123;</div><div class="line">		<span class="string">'effect-1'</span> : &#123;</div><div class="line">			<span class="string">'next'</span> : [</div><div class="line">				<span class="string">'translate3d(0, '</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>, <span class="comment">// transforms for panel 1</span></div><div class="line">				<span class="string">'translate3d(-'</span> + (win.width/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0, 0)'</span>, <span class="comment">// transforms for panel 2</span></div><div class="line">				<span class="string">'translate3d('</span> + (win.width/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0, 0)'</span>, <span class="comment">// transforms for panel 3</span></div><div class="line">				<span class="string">'translate3d(0, -'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span> <span class="comment">// transforms for panel 4</span></div><div class="line">			],</div><div class="line">			<span class="string">'prev'</span> : [</div><div class="line">				<span class="string">'translate3d('</span> + (win.width/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(0, '</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(0, -'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(-'</span> + (win.width/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0, 0)'</span></div><div class="line">			]</div><div class="line">		&#125;,</div><div class="line">		<span class="string">'effect-2'</span> : &#123;</div><div class="line">			<span class="string">'next'</span> : [</div><div class="line">				<span class="string">'translate3d(-'</span> + (win.width/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0, 0)'</span>,</div><div class="line">				<span class="string">'translate3d('</span> + (win.width/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(-'</span> + (win.width/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0, 0)'</span>,</div><div class="line">				<span class="string">'translate3d('</span> + (win.width/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0, 0)'</span></div><div class="line">			],</div><div class="line">			<span class="string">'prev'</span> : [</div><div class="line">				<span class="string">'translate3d(0,-'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(0,-'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(0,'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(0,'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span></div><div class="line">			]</div><div class="line">		&#125;,</div><div class="line">		<span class="string">'effect-3'</span> : &#123;</div><div class="line">			<span class="string">'next'</span> : [</div><div class="line">				<span class="string">'translate3d(0,'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(0,'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(0,'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(0,'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span></div><div class="line">			],</div><div class="line">			<span class="string">'prev'</span> : [</div><div class="line">				<span class="string">'translate3d(0,-'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(0,-'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(0,-'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span>,</div><div class="line">				<span class="string">'translate3d(0,-'</span> + (win.height/<span class="number">2</span>+<span class="number">10</span>) + <span class="string">'px, 0)'</span></div><div class="line">			]</div><div class="line">		&#125;</div><div class="line">	&#125;;	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>接下来要做得就是初始话nav箭头事件，和调整window大小得事件:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">BoxesFx.prototype._initEvents = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> self = <span class="keyword">this</span>, navctrls = <span class="keyword">this</span>.nav.children;</div><div class="line">	<span class="comment">// previous action</span></div><div class="line">	navctrls[<span class="number">0</span>].addEventListener( <span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; self._navigate(<span class="string">'prev'</span>) &#125; );</div><div class="line">	<span class="comment">// next action</span></div><div class="line">	navctrls[<span class="number">1</span>].addEventListener( <span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; self._navigate(<span class="string">'next'</span>) &#125; );</div><div class="line">	<span class="comment">// window resize</span></div><div class="line">	<span class="built_in">window</span>.addEventListener( <span class="string">'resize'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; self._resizeHandler(); &#125; );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>再让我们来看看navigate函数。</p>
<p>首先，我们得到两者，现在展现的面板和即将浮现的面板。我们当然需要重新设置current变量。</p>
<p>接下来，我们加入active类给现在的（即将浮现的）面板去触发在css中定义过对的动画。我们最后将我们之前定义的3D变换给现在的面板。这将使得我们4个面板变化，并使后面得面板滑动浮现。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line">BoxesFx.prototype._navigate = <span class="function"><span class="keyword">function</span>(<span class="params"> dir </span>) </span>&#123;</div><div class="line">	<span class="keyword">if</span>( <span class="keyword">this</span>.isAnimating ) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	<span class="keyword">this</span>.isAnimating = <span class="literal">true</span>;</div><div class="line"></div><div class="line">	<span class="keyword">var</span> self = <span class="keyword">this</span>, currentPanel = <span class="keyword">this</span>.panels[ <span class="keyword">this</span>.current ];</div><div class="line"></div><div class="line">	<span class="keyword">if</span>( dir === <span class="string">'next'</span> ) &#123;</div><div class="line">		<span class="keyword">this</span>.current = <span class="keyword">this</span>.current &lt; <span class="keyword">this</span>.panelsCount - <span class="number">1</span> ? <span class="keyword">this</span>.current + <span class="number">1</span> : <span class="number">0</span>;			</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> &#123;</div><div class="line">		<span class="keyword">this</span>.current = <span class="keyword">this</span>.current &gt; <span class="number">0</span> ? <span class="keyword">this</span>.current - <span class="number">1</span> : <span class="keyword">this</span>.panelsCount - <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">// next panel to be shown</span></div><div class="line">	<span class="keyword">var</span> nextPanel = <span class="keyword">this</span>.panels[ <span class="keyword">this</span>.current ];</div><div class="line">	<span class="comment">// add class active to the next panel to trigger its animation</span></div><div class="line">	classie.add( nextPanel, <span class="string">'active'</span> );</div><div class="line">	<span class="comment">// apply the transforms to the current panel</span></div><div class="line">	<span class="keyword">this</span>._applyTransforms( currentPanel, dir );</div><div class="line"></div><div class="line">	<span class="comment">// let´s track the number of transitions ended per panel</span></div><div class="line">	<span class="keyword">var</span> cntTransTotal = <span class="number">0</span>,</div><div class="line">		</div><div class="line">		<span class="comment">// transition end event function</span></div><div class="line">		onEndTransitionFn = <span class="function"><span class="keyword">function</span>(<span class="params"> ev </span>) </span>&#123;</div><div class="line">			<span class="keyword">if</span>( ev &amp;&amp; !classie.has( ev.target, <span class="string">'bg-img'</span> ) ) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line"></div><div class="line">			<span class="comment">// return if not all panel transitions ended</span></div><div class="line">			++cntTransTotal;</div><div class="line">			<span class="keyword">if</span>( cntTransTotal &lt; self.panelsCount ) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line"></div><div class="line">			<span class="keyword">if</span>( support.transitions ) &#123;</div><div class="line">				<span class="keyword">this</span>.removeEventListener( transEndEventName, onEndTransitionFn );</div><div class="line">			&#125;</div><div class="line"></div><div class="line">			<span class="comment">// remove current class from current panel and add it to the next one</span></div><div class="line">			classie.remove( currentPanel, <span class="string">'current'</span> );</div><div class="line">			classie.add( nextPanel, <span class="string">'current'</span> );</div><div class="line">			<span class="comment">// reset transforms for the currentPanel</span></div><div class="line">			self._resetTransforms( currentPanel );</div><div class="line">			<span class="comment">// remove class active</span></div><div class="line">			classie.remove( nextPanel, <span class="string">'active'</span> );</div><div class="line">			self.isAnimating = <span class="literal">false</span>;</div><div class="line">		&#125;;</div><div class="line"></div><div class="line">	<span class="keyword">if</span>( support.transitions ) &#123;</div><div class="line">		currentPanel.addEventListener( transEndEventName, onEndTransitionFn );</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> &#123;</div><div class="line">		onEndTransitionFn();</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">BoxesFx.prototype._applyTransforms = <span class="function"><span class="keyword">function</span>(<span class="params"> panel, dir </span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line">	[].slice.call( panel.querySelectorAll( <span class="string">'div.bg-img'</span> ) ).forEach( <span class="function"><span class="keyword">function</span>(<span class="params"> tile, pos </span>) </span>&#123;</div><div class="line">		tile.style.WebkitTransform = self.transforms[self.effect][dir][pos];</div><div class="line">		tile.style.transform = self.transforms[self.effect][dir][pos];</div><div class="line">	&#125; );</div><div class="line">&#125;</div><div class="line"></div><div class="line">BoxesFx.prototype._resetTransforms = <span class="function"><span class="keyword">function</span>(<span class="params"> panel </span>) </span>&#123;</div><div class="line">	[].slice.call( panel.querySelectorAll( <span class="string">'div.bg-img'</span> ) ).forEach( <span class="function"><span class="keyword">function</span>(<span class="params"> tile </span>) </span>&#123;</div><div class="line">		tile.style.WebkitTransform = <span class="string">'none'</span>;</div><div class="line">		tile.style.transform = <span class="string">'none'</span>;</div><div class="line">	&#125; );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong> 本文翻译自<a href="http://tympanus.net/codrops/2014/06/11/how-to-create-a-tiled-background-slideshow/" target="_blank" rel="external">How to Create a Tiled Background Slideshow</a>,如果有问题请在评论中指出,谢谢 </strong></p>

    </div>
  </div>
</section>

      </section>
    <footer style="text-align:center">
  啦啦啦，主题搭建中。。。
</footer>
    </div>
  </div>
  <script src="/js/simple_build.js"></script>
</body>
</html>