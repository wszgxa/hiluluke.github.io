<!DOCTYPE html><html><head><meta charset="utf-8"><link rel="dns-prefetch" href="//7fvhwe.com1.z0.glb.clouddn.com/"><link rel="dns-prefetch" href="//hilus-note.disqus.com"><link rel="dns-prefetch" href="//www.google-analytics.com/"><title> canvas 笔记（1） | hilu&#39;s note</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="alternate" href="" title="hilu&#39;s note" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><style>.menu-home .menu-item-home{color:#b71c1c}.menu-categories .menu-item-categories{color:#b71c1c}.menu-tags .menu-item-tags{color:#b71c1c}.menu-about .menu-item-about{color:#b71c1c}.menu-rss .menu-item-rss{color:#b71c1c}</style><style>blockquote,body,button,dd,dl,dt,fieldset,form,h1,h2,h3,h4,h5,h6,hr,input,legend,li,ol,p,pre,td,textarea,th,ul{margin:0;padding:0}.wrap,body{position:relative}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:100%}address,cite,dfn,em,i,var{font-style:normal}code,kbd,pre,samp{font-family:courier new,courier,monospace}small{font-size:16px}ol,ul{list-style:none}a{text-decoration:none}.archives .content-wrap a:hover,.cate-list a:hover,.content .gist .gist-file .gist-meta a:hover,.footer a:hover{text-decoration:underline}fieldset,img{border:0}input,select{-webkit-tap-highlight-color:transparent}@-moz-keyframes flow{from{transform:translate3d(0,-30px,0);opacity:0}to{transform:translate3d(0,0,0);opacity:1}}@-webkit-keyframes flow{from{transform:translate3d(0,-30px,0);opacity:0}to{transform:translate3d(0,0,0);opacity:1}}@-o-keyframes flow{from{transform:translate3d(0,-30px,0);opacity:0}to{transform:translate3d(0,0,0);opacity:1}}@keyframes flow{from{transform:translate3d(0,-30px,0);opacity:0}to{transform:translate3d(0,0,0);opacity:1}}body,html{height:100%}html{-webkit-overflow-scrolling:touch;-webkit-text-size-adjust:100%}body{word-break:break-all;word-wrap:break-word;font-size:1em;line-height:1.5;font-family:"Lantinghei SC","Open Sans",Arial,"Hiragino Sans GB","Microsoft YaHei",STHeiti,"WenQuanYi Micro Hei",SimSun,Helvetica,sans-serif;background:#fefefe;color:#323232}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_1469071762_054906.eot);src:url(//at.alicdn.com/t/font_1469071762_054906.eot?#iefix) format('embedded-opentype'),url(//at.alicdn.com/t/font_1469071762_054906.woff) format('woff'),url(//at.alicdn.com/t/font_1469071762_054906.ttf) format('truetype'),url(//at.alicdn.com/t/font_1469071762_054906.svg#iconfont) format('svg')}.i-codepen,.i-douban,.i-facebook,.i-github,.i-left,.i-next,.i-right,.i-twitter,.i-v2ex,.i-weibo,.i-zhihu{font-family:iconfont;font-size:18px;font-style:normal;color:#616171}.i-weibo::after{content:'\e607'}.i-github::after{content:'\e60a'}.i-v2ex::after{content:'\e606'}.i-douban::after{content:'\e605'}.i-zhihu::after{content:'\e608'}.i-twitter::after{content:'\e609'}.i-facebook::after{content:'\e60b'}.i-codepen::after{content:'\e601'}.i-left::after{content:'\e600'}.i-right::after{content:'\e602'}.i-next::after{content:'\e603'}.wrap{transition:.3s all ease-in-out}.side,.sidebar{position:fixed}.header{max-width:840px;margin:0 auto 20px;text-align:center;background-color:#fff;box-shadow:0 1px 3px #e3e3e3;-webkit-box-shadow:0 1px 3px #e3e3e3;-moz-box-shadow:0 1px 3px #e3e3e3;-ms-box-shadow:0 1px 3px #e3e3e3;-o-box-shadow:0 1px 3px #e3e3e3}.header a:hover,.side .arrows,.side .top{background-color:#e3e3e3}.header a{color:#323232;display:inline-block;padding:10px;transition:background-color .2s ease}.header .ac{color:#b71c1c}.side{bottom:40px;transition:.3s all}.side .arrows,.side .top{width:35px;height:35px;border:1px solid transparent;line-height:35px;text-align:center;cursor:pointer;border-radius:3px}.side .arrows:after,.side .top:after{content:'\e602';font-family:iconfont;font-size:16px;color:#323232}.sidebar .desc,.sidebar .name{font-size:15px;text-align:center}.side .arrows:hover:after,.side .top:hover:after{color:#b71c1c}.side .top{margin-bottom:1px;transform:rotate3d(0,0,1,-90deg);-webkit-transform:rotate3d(0,0,1,-90deg);-moz-transform:rotate3d(0,0,1,-90deg);-ms-transform:rotate3d(0,0,1,-90deg);-o-transform:rotate3d(0,0,1,-90deg)}.sideShow .arrows{transform:rotate3d(0,1,0,180deg);-webkit-transform:rotate3d(0,1,0,180deg);-moz-transform:rotate3d(0,1,0,180deg);-ms-transform:rotate3d(0,1,0,180deg);-o-transform:rotate3d(0,1,0,180deg)}.sideShow .side{transform:translate3d(2px,0,0);-webkit-transform:translate3d(2px,0,0);-moz-transform:translate3d(2px,0,0);-ms-transform:translate3d(2px,0,0);-o-transform:translate3d(2px,0,0)}.sideShow .wrap{padding-left:210px}.sideShow .sidebar{transform:none;-webkit-transform:none;-moz-transform:none;-ms-transform:none;-o-transform:none;box-shadow:1px 0 5px #ededed;-webkit-box-shadow:1px 0 5px #ededed;-moz-box-shadow:1px 0 5px #ededed;-ms-box-shadow:1px 0 5px #ededed;-o-box-shadow:1px 0 5px #ededed}.sidebar{left:0;top:0;bottom:0;z-index:2;width:210px;transform:translate3d(-210px,0,0);-webkit-transform:translate3d(-210px,0,0);-moz-transform:translate3d(-210px,0,0);-ms-transform:translate3d(-210px,0,0);-o-transform:translate3d(-210px,0,0);transition:transform .3s ease-in-out;background-color:#ededed}.sidebar .head-icon{margin:30px auto 10px;width:72px;height:72px}.sidebar .head-icon img{width:60px;height:60px;border:6px solid rgba(255,255,255,.85);border-radius:50%}.sidebar .desc{margin:0 auto;color:#707070;max-width:180px}.sidebar .name{color:#000;padding:0 0 10px}.sidebar .side-nav{margin-top:35px;text-align:center;font-size:16px}.sidebar .side-nav .nav-item{display:inline-block;padding:0 4px}.sidebar .side-nav .nav-item span{color:#616171;display:block;transition:.2s color}.sidebar .side-nav .nav-item:hover span,.sidebar .social-wrap .item:hover i{color:#000}.sidebar .side-nav .nav-item:nth-child(n+2){border-left:2px solid #e0e0e0}.sidebar .social-wrap{margin:30px auto 0;width:180px;text-align:center}.sidebar .social-wrap .item{padding:5px;display:inline-block;transition:.2s all ease-in-out}.sidebar .social-wrap .item:hover{background-color:#e3e3e3}.content{max-width:760px;min-height:768px;margin:0 auto;padding:20px 40px;background-color:#fff;box-shadow:0 1px 3px #e3e3e3;-webkit-box-shadow:0 1px 3px #e3e3e3;-moz-box-shadow:0 1px 3px #e3e3e3;-ms-box-shadow:0 1px 3px #e3e3e3;-o-box-shadow:0 1px 3px #e3e3e3}.archives{margin-bottom:50px;animation:flow 530ms ease-in-out}.archives .title-wrap{margin:20px 0;padding-bottom:10px;border-bottom:1px solid #e0e0e0}.archives .read-more a:hover,.archives .title-wrap .page-info a:hover{border-bottom:1px solid #1b1a1a}.archives .title-wrap h1{font-size:1.8em;color:#202020}.archives .title-wrap .post-title{position:relative;display:inline-block}.archives .title-wrap .post-title::before{content:'';bottom:0;width:100%;position:absolute;border-top:2px solid #1b1a1a;transform:scale3d(0,1,1);-webkit-transform:scale3d(0,1,1);-moz-transform:scale3d(0,1,1);-ms-transform:scale3d(0,1,1);-o-transform:scale3d(0,1,1);transition:transform .2s ease-in-out}.archives .title-wrap .post-title:hover::before{transform:scale3d(1,1,1);-webkit-transform:scale3d(1,1,1);-moz-transform:scale3d(1,1,1);-ms-transform:scale3d(1,1,1);-o-transform:scale3d(1,1,1)}.archives .title-wrap .page-info{font-size:16px;color:#616171}.archives .title-wrap .page-info a{color:#616171}.archives .read-more{text-align:left}.archives .read-more a{color:#202020;line-height:14px;transition:all .2s ease-in-out}.archives .read-more a:hover span{color:#000}.archives .read-more a span{font-size:14px}.archives .read-more a span::after{font-size:12px}.archives .content-wrap h1,.archives .content-wrap h2,.archives .content-wrap h3,.archives .content-wrap h4{color:#b71c1c;margin:1.5em 0 1em}.archives .content-wrap h1{font-size:1.75em}.archives .content-wrap h2{font-size:1.5em}.archives .content-wrap h3,.archives .content-wrap h4{font-size:1.1em}.archives .content-wrap blockquote{border-left:.3em solid #e0e0e0}.archives .content-wrap blockquote p{padding-left:.8em}.archives .content-wrap ul{padding-left:1.5em}.archives .content-wrap ul li{list-style:circle}.archives .content-wrap .code,.archives .content-wrap figure table{border:none}.archives .content-wrap p{margin:1em 0;text-align:justify}.archives .content-wrap img{display:block;max-width:90%;margin:0 auto;border:1px solid #e0e0e0}.archives .content-wrap a{color:#4078c0}.page-nav .current,.page-nav a{color:#616171}.archives .content-wrap table{max-width:80%;margin:0 auto;border:1px solid #ddd;border-spacing:0;border-collapse:collapse}.archives .content-wrap th{padding:8px;text-align:left;line-height:1.42857143;vertical-align:bottom;border:1px solid #ddd;border-bottom-width:2px;box-sizing:border-box}.cate-head,.ct-title,.footer,.page-nav,.tags-cloud{text-align:center}.archives .content-wrap td{border:1px solid #ddd;padding:8px;line-height:1.42857143;vertical-align:top}.page-nav .current,.page-nav .extend:hover,.page-nav .page-number:hover{border-bottom:1px solid #000}.page-nav{margin:40px 0}.page-nav .extend,.page-nav .page-number,.page-nav .space{position:relative;display:inline-block;width:30px;height:30px;margin:0 10px}.page-nav .page-number{text-align:center;font-size:16px;line-height:30px}.page-nav .extend{line-height:30px}.page-nav .extend i{font-size:12px}.ds-thread{width:96%;margin:0 auto}.content .highlight,.content pre{background:#fafafa;margin:1em auto;padding:10px;overflow:auto;color:#515151;line-height:1.5;white-space:pre;word-spacing:normal;word-break:normal}.content .gist .gist-file .gist-data .line-numbers{color:#666;font-size:.85em}.content code,.content pre{font-family:consolas,menlo,monospace}.content code{background:#fefefe;text-shadow:0 1px #fff;padding:0 .3em}.content pre code{background:0 0;text-shadow:none;padding:0}.content .highlight pre{border:none;margin:0;padding:0}.content .highlight table{margin:0;width:auto}.content .highlight td{border:none;padding:0}.content .highlight figcaption{font-size:.85em;color:#999;line-height:1em;margin-bottom:1em}.content .highlight figcaption a{float:right}.content .highlight .gutter pre{display:none}.content .highlight .line{height:1.5em}.content .highlight .line.marked{background:#515151}.content .gist{margin:0 -20px;border-style:solid;border-color:#e0e0e0;border-width:1px 0;background:#fafafa;padding:15px 20px 15px 0}.content .gist .gist-file{border:none;font-family:font-mono;margin:0}.content .gist .gist-file .gist-data{background:0 0;border:none}.content .gist .gist-file .gist-data .line-numbers{background:0 0;border:none;padding:0 20px 0 0}.content .gist .gist-file .gist-data .line-data{padding:0!important}.content .gist .gist-file .highlight{margin:0;padding:0;border:none}.content .gist .gist-file .gist-meta{background:#fafafa;color:#999;font:.85em font-sans;text-shadow:0 0;padding:0;margin-top:1em;margin-left:20px}.content .gist .gist-file .gist-meta a{color:color-link;font-weight:400}pre .comment,pre .title{color:#999}pre .attribute,pre .css .class,pre .css .id,pre .css .pseudo,pre .html .doctype,pre .regexp,pre .ruby .constant,pre .tag,pre .variable,pre .xml .doctype,pre .xml .pi,pre .xml .tag .title{color:#f2777a}pre .built_in,pre .constant,pre .literal,pre .number,pre .params,pre .preprocessor{color:#f99157}pre .class,pre .css .rules .attribute,pre .header,pre .inheritance,pre .ruby .class .title,pre .ruby .symbol,pre .string,pre .value,pre .xml .cdata{color:#9c9}pre .css .hexcolor{color:#6cc}pre .coffeescript .title,pre .function,pre .javascript .title,pre .perl .sub,pre .python .decorator,pre .python .title,pre .ruby .function .title,pre .ruby .title .keyword{color:#69c}pre .javascript .function,pre .keyword{color:#c9c}.cate-head{margin-top:20px;font-size:1.5em}.cate-list-item{display:inline-block;padding:0 8px}.cate-list{max-width:80%;margin:40px auto 0}.cate-list a{color:#323232;padding:5px}.cate-list span,.ct-title small{color:#616171}.cate-list span:before{content:'['}.cate-list span:after{content:']'}.tags-cloud{width:80%;margin:20px auto 0;text-indent:4px;word-break:normal}.tags-cloud a{display:inline-block;margin:5px}.tags-cloud a:hover{border-bottom:1px solid #e3e3e3}.ct-title{margin:10px auto 20px}.ct-title h2{font-size:1.75em}.footer{max-width:760px;margin:10px auto 0;background-color:#fff;box-shadow:0 0 5px #e3e3e3;-webkit-box-shadow:0 0 5px #e3e3e3;-moz-box-shadow:0 0 5px #e3e3e3;-ms-box-shadow:0 0 5px #e3e3e3;-o-box-shadow:0 0 5px #e3e3e3;padding:10px 40px}.footer a{color:#4078c0}.footer div{padding:5px}@media screen and (max-width:800px){.side{display:none}.content{padding:20px}.footer,.header{max-width:800px}.page-nav .page-number{width:25px;height:25px;line-height:25px}}</style></head><body><script type="text/javascript">!function(){"true"==localStorage.getItem("sidebarState")&&(document.body.className="sideShow")}()</script><div id="container"><aside class="sidebar"><div class="head-icon"> <a href="/about"><img src="/avatar.jpeg"></a></div><div class="name">hiluluke</div><div class="desc"><h4>我是一个粉刷匠</h4></div><nav class="side-nav"><div class="nav-item"> <a href="/"><span>36</span> <span>日志</span></a></div><div class="nav-item"> <a href="/categories"><span>8</span> <span>分类</span></a></div><div class="nav-item"> <a href="/tags"><span>26</span> <span>标签</span></a></div></nav><div class="social-wrap"><a href="https://github.com/wszgxa" target="_blank"><div class="item"><i class="i-github"></i></div></a><a href="http://v2ex.com/member/hiluluke" target="_blank"><div class="item"><i class="i-v2ex"></i></div></a><a href="https://www.zhihu.com/people/zhao-guo-xu" target="_blank"><div class="item"><i class="i-zhihu"></i></div></a><a href="https://twitter.com/Hiluluke" target="_blank"><div class="item"><i class="i-twitter"></i></div></a><a href="http://codepen.io/hiluluke" target="_blank"><div class="item"><i class="i-codepen"></i></div></a></div></aside><div class="wrap"><div class="side"><div class="top" id="back-top"></div><div class="arrows" id="nav-btn"></div></div><header class="header menu-2015"><nav> <a class="menu-item-home" href="/">首页</a> <a class="menu-item-categories" href="/categories">分类</a> <a class="menu-item-tags" href="/tags">标签</a> <a class="menu-item-about" href="/about">关于</a> <a class="menu-item-rss" href="/atom.xml">RSS</a></nav></header><section id="main" class="content"><div class="archives-wrap"><div class="archives"><div class="title-wrap"><h1>canvas 笔记（1）</h1><div class="page-info"> <span>By <a href="/about">hiluluke</a> on</span> <time datetime="2015-10-24T16:00:00.000Z" itemprop="datePublished">Oct 25 2015</time></div></div><div class="content-wrap"><h2 id="初步"><a href="#初步" class="headerlink" title="初步"></a>初步</h2><p>首先需要在html中定义html结构<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"mycanvas"</span> <span class="attr">width</span>=<span class="string">"600"</span> <span class="attr">height</span>=<span class="string">"300"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>然后需要在js上获取canvas和定义动画类型</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">"mycanvas"</span>); <span class="comment">//获取canvas</span></span><br><span class="line"><span class="keyword">var</span> context = canvas.getContext(<span class="string">"2d"</span>);<span class="comment">//定义2d动画</span></span><br></pre></td></tr></table></figure><p>然后就可以进行一些绘图操作：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">context.lineWidth = <span class="number">10</span>;定义线条宽度</span><br><span class="line">context.strokeStyle = <span class="string">"blue"</span>;<span class="comment">//定义线条样式（颜色）</span></span><br><span class="line">context.moveTo(<span class="number">50</span>, canvas.height)；移动光标</span><br><span class="line">contex.lineTo(x,y)<span class="comment">//从光标的位置画一条线到(x,y)</span></span><br><span class="line">context.stroke()绘图</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="线条"><a href="#线条" class="headerlink" title="线条"></a>线条</h2><h3 id="画弧"><a href="#画弧" class="headerlink" title="画弧"></a>画弧</h3><ul><li>context.arc(a, b, c, d, e, f);</li></ul><p>第一个参数，第二个参数是圆心坐标，第三个参数是开始弧度，第四个是结束弧度。最后一个参数是方向False = 顺时针，true = 逆时针。</p><ul><li>context.arcTo(x1, y1, x2, y2, radius);</li></ul><p>(x1,y1)弧的起点 （x2，y2）弧的终点 radius半径</p><h3 id="画二次曲线"><a href="#画二次曲线" class="headerlink" title="画二次曲线"></a>画二次曲线</h3><ul><li>context.quadraticCurveTo(controlX, controlY, endingPointX, endingPointY);</li></ul><p><img src="http://7fvhwe.com1.z0.glb.clouddn.com/选区_024.png" alt=""></p><p>其中context point是开始的光标位置。其中有4个相切。midpoint1,2上各有两个正切</p><h3 id="画贝塞尔曲线"><a href="#画贝塞尔曲线" class="headerlink" title="画贝塞尔曲线"></a>画贝塞尔曲线</h3><ul><li>context.bezierCurveTo(controlPointX1, controlPointY1,controlPointX2, controlPointY2, endingPointX, endingPointY);</li></ul><p>!()[<a href="http://7fvhwe.com1.z0.glb.clouddn.com/选区_025.png]" target="_blank" rel="noopener">http://7fvhwe.com1.z0.glb.clouddn.com/选区_025.png]</a></p><h3 id="线段端点"><a href="#线段端点" class="headerlink" title="线段端点"></a>线段端点</h3><ul><li><p>context.linejoin=x;线交点样式<br>其中x有3个选线：bevel（斜角）、round（圆角）、miter（默认尖角）</p></li><li><p>context.linegap=x;线的端点样式<br>其中x有3个参数：butt（默认，平直边缘）、round(圆形线帽)、square（正方形线帽）</p></li></ul><h2 id="文字"><a href="#文字" class="headerlink" title="文字"></a>文字</h2><p>context.font = “40pt Calibri”;设置字体大小<br>context.fillText(“Hello World!”, canvas.width / 2, 120);绘文字<br>context.strokeText(“Hello World!”, x, y);等价于上面</p><h2 id="线条demo：分型树"><a href="#线条demo：分型树" class="headerlink" title="线条demo：分型树"></a>线条demo：分型树</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawBranches</span>(<span class="params">context, startX, startY, trunkWidth, level</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (level &lt; <span class="number">12</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> changeX = <span class="number">100</span> / (level + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">var</span> changeY = <span class="number">200</span> / (level + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">var</span> topRightX = startX + <span class="built_in">Math</span>.random() * changeX+<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">var</span> topRightY = startY - <span class="built_in">Math</span>.random() * changeY;</span><br><span class="line">    <span class="keyword">var</span> topLeftX = startX - <span class="built_in">Math</span>.random() * changeX<span class="number">-10</span>;</span><br><span class="line">    <span class="keyword">var</span> topLeftY = startY - <span class="built_in">Math</span>.random() * changeY;</span><br><span class="line">    <span class="comment">// draw right branch</span></span><br><span class="line">    context.beginPath();</span><br><span class="line">    context.moveTo(startX + trunkWidth / <span class="number">4</span>, startY);</span><br><span class="line">    context.quadraticCurveTo(startX + trunkWidth / <span class="number">4</span>, startY - trunkWidth, topRightX, topRightY);</span><br><span class="line">    context.lineWidth = trunkWidth;</span><br><span class="line">    context.lineCap = <span class="string">"round"</span>;</span><br><span class="line">    context.stroke();</span><br><span class="line">    <span class="comment">// draw left branch</span></span><br><span class="line">    context.beginPath();</span><br><span class="line">    context.moveTo(startX - trunkWidth / <span class="number">4</span>, startY);</span><br><span class="line">    context.quadraticCurveTo(startX - trunkWidth / <span class="number">4</span>, startY - trunkWidth, topLeftX, topLeftY);</span><br><span class="line">    context.lineWidth = trunkWidth;</span><br><span class="line">    context.stroke();</span><br><span class="line">    drawBranches(context, topRightX, topRightY, trunkWidth * <span class="number">0.7</span>, level + <span class="number">1</span>);</span><br><span class="line">    drawBranches(context, topLeftX, topLeftY, trunkWidth * <span class="number">0.7</span>, level + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="形状"><a href="#形状" class="headerlink" title="形状"></a>形状</h2><h3 id="矩形"><a href="#矩形" class="headerlink" title="矩形"></a>矩形</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">context.rect(x,y,width,height);</span><br><span class="line">context.fillStyle = <span class="string">"#8ED6FF"</span>;</span><br><span class="line">context.fill();</span><br><span class="line">context.lineWidth = <span class="number">5</span>;</span><br><span class="line">context.strokeStyle = <span class="string">"black"</span>;</span><br></pre></td></tr></table></figure><p>上述方法绘制一个带边框的矩形。(x,y)为开始绘制的左上定点，width和height为宽高</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">context.fillRect(x,y,width,height);</span><br><span class="line">context.strokeRect(x,y,width,height);</span><br></pre></td></tr></table></figure><p>上面为绘制填充矩形和描边矩形，就一个没边，一个没填充</p><h3 id="画一个圆"><a href="#画一个圆" class="headerlink" title="画一个圆"></a>画一个圆</h3><p>之前画弧的arc</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">context.arc(canvas.width / <span class="number">2</span>, canvas.height / <span class="number">2</span>, <span class="number">70</span>, <span class="number">0</span>, <span class="number">2</span> *<span class="built_in">Math</span>.PI, <span class="literal">false</span>);</span><br><span class="line">context.fillStyle = <span class="string">"#8ED6FF"</span>;</span><br><span class="line">context.fill();</span><br><span class="line">context.lineWidth = <span class="number">5</span>;</span><br><span class="line">context.strokeStyle = <span class="string">"black"</span>;</span><br></pre></td></tr></table></figure><h3 id="自定义形状和样式"><a href="#自定义形状和样式" class="headerlink" title="自定义形状和样式"></a>自定义形状和样式</h3><ul><li>context.closePath();闭合路径</li><li>context.fillStyle = fillStyle;其中fillStyle可以是一个颜色，还可以是一个图片也可以是一个渐变对象：<br> grd = context.createLinearGradient(canvas.width <em>2 / 5, triangleY, canvas.width</em> 2 / 5, triangleY + triangleHeight);<br> grd.addColorStop(0, “#8ED6FF”); // light blue<br> grd.addColorStop(1, “#004CB3”); // dark blue<br>grd = context.createLinearGradient(canvas.width <em>2 / 5, triangleY, canvas.width</em> 2 / 5, triangleY + triangleHeight);<br>线性渐变上面4个参数分别是渐变开始点的(x,y)坐标和结束点(x,y)坐标</li></ul><p>然后指定渐变颜色是：<br>grd.addColorStop(0, “#8ED6FF”); // light blue<br>grd.addColorStop(1, “#004CB3”); // dark blue<br>第一个参数是百分比位置，第二个参数是渐变颜色值</p><ul><li>grd = context.createRadialGradient(centerX, centerY, 10, centerX, centerY, 100);</li></ul><p>径向渐变和线性渐变差不多,其中第三个参数和第六个参数分别是开始圆的半径和结束圆的半径</p><ul><li>var pattern = context.createPattern(image,”repeat|repeat-x|repeat-y|no-repeat”);</li></ul><p>第一个参数可以是image或者video或者画布，第二个参数指定重复。<br>他是指定为fillStyle的。可以用来填充图像、视频、画布。</p><h3 id="画透明的形状"><a href="#画透明的形状" class="headerlink" title="画透明的形状"></a>画透明的形状</h3><p>context.globalAlpha = 0.5;<br>设置全局透明度。</p><h3 id="save和restore"><a href="#save和restore" class="headerlink" title="save和restore"></a>save和restore</h3><p>context.save();保存之前的样式设置<br>context.restore();恢复之前的样式设置</p><h3 id="图形混合运算"><a href="#图形混合运算" class="headerlink" title="图形混合运算"></a>图形混合运算</h3><ul><li>context.globalCompositeOperation = x;<br>其中x可以是：source-atop / source-in / source-out / source-over / destination-atop / destionation-in / destionation-out / destination-over / lighter / xor / copy</li></ul><p><img src="http://7fvhwe.com1.z0.glb.clouddn.com/选区_026.png" alt=""></p><p>上面的图都是在相同的位置画一个正方形和一个圆，然后用了不同的globalCompositeOperation得到的不同效果。</p><p>注意是先画的正方形后画的圆形</p><h2 id="图片和视频"><a href="#图片和视频" class="headerlink" title="图片和视频"></a>图片和视频</h2><h3 id="画一张图"><a href="#画一张图" class="headerlink" title="画一张图"></a>画一张图</h3><ul><li><p>context.drawImage(this,x,y)<br>其中this是图片对象，而(x,y)是坐标。一般将上面代码放在image加载回调里面。</p></li><li><p>裁剪图片</p></li></ul><p>Context.drawImage(imageObj, sourceX, sourceY, sourceWidth, sourceHight,<br>destX, destY, destWidth, destHeight);看下面这张图应该就能懂了</p><p><img src="http://7fvhwe.com1.z0.glb.clouddn.com/选区_028.png" alt=""></p><ul><li>画视频</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="built_in">window</span>.requestAnimFrame = (<span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.requestAnimationFrame ||</span><br><span class="line">    <span class="built_in">window</span>.webkitRequestAnimationFrame ||</span><br><span class="line">    <span class="built_in">window</span>.mozRequestAnimationFrame ||</span><br><span class="line">    <span class="built_in">window</span>.oRequestAnimationFrame ||</span><br><span class="line">    <span class="built_in">window</span>.msRequestAnimationFrame ||</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;</span><br><span class="line">      <span class="built_in">window</span>.setTimeout(callback, <span class="number">1000</span> / <span class="number">60</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;)();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">drawFrame</span>(<span class="params">context, video</span>)</span>&#123;</span><br><span class="line">    context.drawImage(video, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    requestAnimFrame(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      drawFrame(context, video);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">"myCanvas"</span>);</span><br><span class="line">    <span class="keyword">var</span> context = canvas.getContext(<span class="string">"2d"</span>);</span><br><span class="line">    <span class="keyword">var</span> video = <span class="built_in">document</span>.getElementById(<span class="string">"myVideo"</span>);</span><br><span class="line">    drawFrame(context, video);</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;video id=<span class="string">"myVideo"</span> autoplay=<span class="string">"true"</span> loop=<span class="string">"true"</span> style=<span class="string">"display:none;"</span>&gt;</span><br><span class="line">  &lt;source src=<span class="string">"http://www.html5canvastutorials.com/cookbook/ch3/1369_03_03/BigBuckBunny_640x360.ogv"</span> type=<span class="string">"video/ogg"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"http://www.html5canvastutorials.com/cookbook/ch3/1369_03_03/BigBuckBunny_640x360.mp4"</span> <span class="attr">type</span>=<span class="string">"video/mp4"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span></span><br><span class="line">  &lt;canvas id=<span class="string">"myCanvas"</span> width=<span class="string">"600"</span> height=<span class="string">"360"</span> style=<span class="string">"border:1px solid black;"</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/canvas&gt;</span></span><br></pre></td></tr></table></figure><p>主要思想：将video隐藏，然后一帧一帧抓video呈现在canvas</p><ul><li>获取图片数据</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> imagedata = context.getImageData(sourceX,sourceY,sourceWidth,sourceHeight)</span><br></pre></td></tr></table></figure><p>参数分别是起点坐标和宽高。<br>获取已经画好的image的数据，其返回一个对象。<br>imagedata.data.length大小数据,其中data表示多少个像素<br>imagedata.width宽度<br>imagedata.height高度数据</p><ul><li>像素反色</li></ul><p>context.putImageData(imageData, destX, destY);<br>将image数据放进固定位置</p><p>反色代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">context.drawImage(<span class="keyword">this</span>, destX, destY);</span><br><span class="line"><span class="keyword">var</span> imageData = context.getImageData(sourceX, sourceY,</span><br><span class="line">sourceWidth, sourceHeight);</span><br><span class="line"><span class="keyword">var</span> data = imageData.data;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.length; i += <span class="number">4</span>) &#123;</span><br><span class="line">  data[i] = <span class="number">255</span> - data[i]; <span class="comment">// red</span></span><br><span class="line">  data[i + <span class="number">1</span>] = <span class="number">255</span> - data[i + <span class="number">1</span>]; <span class="comment">// green</span></span><br><span class="line">  data[i + <span class="number">2</span>] = <span class="number">255</span> - data[i + <span class="number">2</span>]; <span class="comment">// blue</span></span><br><span class="line">  <span class="comment">// i+3 is alpha (the fourth element)</span></span><br><span class="line">&#125;</span><br><span class="line">  <span class="comment">// overwrite original image with</span></span><br><span class="line">  <span class="comment">// new image data</span></span><br><span class="line">  context.putImageData(imageData, destX, destY);</span><br><span class="line">&#125;;</span><br><span class="line">  imageObj.src = <span class="string">"jet_300x214.jpg"</span>;</span><br></pre></td></tr></table></figure><ul><li>转变图片灰度</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.length; i += <span class="number">4</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> brightness = <span class="number">0.34</span> * data[i] + <span class="number">0.5</span> * data[i + <span class="number">1</span>] + <span class="number">0.16</span> * data[i + <span class="number">2</span>];</span><br><span class="line">  data[i] = brightness; <span class="comment">// red</span></span><br><span class="line">  data[i + <span class="number">1</span>] = brightness; <span class="comment">// green</span></span><br><span class="line">  data[i + <span class="number">2</span>] = brightness; <span class="comment">// blue</span></span><br><span class="line">  <span class="comment">// i+3 is alpha (the fourth element)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>将一个canvas画布转换成data URL<br>可以使用local storge将data url数据存储到本地</li></ul><p>var dataURL = canvas.toDataURL();</p><p>其中返回的dataURL就是data URL<br>将datauri指定在src中就可以载入图片。</p></div></div></div><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section><footer class="footer"><div>我是一个粉刷匠</div><div>由 <a href="https://hexo.io/">Hexo</a> 强力驱动 | 主题- <a href="https://github.com/wszgxa/hexo-theme-simple">Simple</a></div></footer></div></div><script src="/js/simple_build.js"></script><script type="text/javascript">function run_disqus_script(s){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/"+s,(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}var disqus_shortname="hilus-note",disqus_identifier="2015/10/25/canvasNote1/",disqus_title="canvas 笔记（1）",disqus_url="http://hiluluke.cn/2015/10/25/canvasNote1/";run_disqus_script("count.js"),run_disqus_script("embed.js")</script><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-83014983-1","auto"),ga("send","pageview")</script></body></html>