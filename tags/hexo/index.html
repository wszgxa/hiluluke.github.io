<!DOCTYPE html><html><head><title> tag: hexo | hilu&#39;s note</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta charset="utf-8"><link rel="alternate" href="/atom.xml" title="hilu&#39;s note" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/style.css"></head><body><script type="text/javascript">!function(){"true"==localStorage.getItem("sidebarState")&&(document.body.className="sideShow")}()</script><div id="container"><aside class="sidebar"><div class="head-icon"> <a href="/about"><img src="/avatar.jpeg"></a></div><div class="name">hiluluke</div><div class="desc"><h4>我是一个粉刷匠</h4></div><nav class="side-nav"><div class="nav-item"> <a href="/archives"><span>27</span> <span>日志</span></a></div><div class="nav-item"> <a href="/categories"><span>7</span> <span>分类</span></a></div><div class="nav-item"> <a href="/tags"><span>22</span> <span>标签</span></a></div></nav><div class="social-wrap"><a href="https://github.com/wszgxa" target="_blank"><div class="item"><i class="i-github"></i></div></a><a href="http://v2ex.com/member/hiluluke" target="_blank"><div class="item"><i class="i-v2ex"></i></div></a><a href="https://www.zhihu.com/people/zhao-guo-xu" target="_blank"><div class="item"><i class="i-zhihu"></i></div></a><a href="https://twitter.com/Hiluluke" target="_blank"><div class="item"><i class="i-twitter"></i></div></a><a href="http://codepen.io/hiluluke" target="_blank"><div class="item"><i class="i-codepen"></i></div></a></div></aside><div class="wrap"><div class="side"><div class="top" id="back-top"></div><div class="arrows" id="nav-btn"></div></div><header class="header"><nav> <a href="/">首页</a> <a href="/categories">分类</a> <a href="/tags">标签</a> <a href="/about">关于</a> <a href="/atom.xml">RSS</a></nav></header><section id="main" class="content"><section class="archives-wrap"><div class="ct-title"><h2>hexo <small>标签</small></h2></div><div class="archives"><div class="title-wrap"><a class="post-title" href="/2016/08/19/hexo-compress/"><h1>自动化部署hexo</h1></a><div class="page-info"> <span>By <a href="/about">hiluluke</a> on</span> <time datetime="2016-08-18T16:00:00.000Z" itemprop="datePublished">Aug 19 2016</time></div></div><div class="content-wrap"><p>作为一名小前端，对于页面的优化肯定是有追求的。本文将利用gulp来压缩hexo生成的文件，并利用npm命令自动部署我们的博客。</p><h2 id="添加gulp"><a href="#添加gulp" class="headerlink" title="添加gulp"></a>添加gulp</h2><p>首先你需要全局安装gulp: <code>npm install -g gulp</code>。</p><p>然后在你的hexo根文件夹下增加一个gulpfile.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">var</span> minifycss = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>);</div><div class="line"><span class="keyword">var</span> htmlmin = <span class="built_in">require</span>(<span class="string">'gulp-htmlmin'</span>);</div><div class="line"><span class="keyword">var</span> htmlclean = <span class="built_in">require</span>(<span class="string">'gulp-htmlclean'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 压缩 public 目录 css</span></div><div class="line">gulp.task(<span class="string">'minify-css'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./public/**/*.css'</span>)</div><div class="line">    .pipe(minifycss())</div><div class="line">    .pipe(gulp.dest(<span class="string">'./public'</span>));</div><div class="line">&#125;);</div><div class="line"><span class="comment">// 压缩 public 目录 html</span></div><div class="line">gulp.task(<span class="string">'minify-html'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./public/**/*.html'</span>)</div><div class="line">    .pipe(htmlclean())</div><div class="line">    .pipe(htmlmin(&#123;</div><div class="line">      removeComments: <span class="literal">true</span>,</div><div class="line">      minifyJS: <span class="literal">true</span>,</div><div class="line">      minifyCSS: <span class="literal">true</span>,</div><div class="line">      minifyURLs: <span class="literal">true</span>,</div><div class="line">    &#125;))</div><div class="line">    .pipe(gulp.dest(<span class="string">'./public'</span>))</div><div class="line">&#125;);</div><div class="line"><span class="comment">// 执行 gulp 命令时执行的任务</span></div><div class="line">gulp.task(<span class="string">'default'</span>, [</div><div class="line">  <span class="string">'minify-html'</span>,<span class="string">'minify-css'</span></div><div class="line">]);</div></pre></td></tr></table></figure><p>在上面如你所看到，有用4个node_modules，需要安装一下：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev gulp</div><div class="line">npm install --save-dev gulp-minify-css</div><div class="line">npm install --save-dev gulp-htmlmin</div><div class="line">npm install --save-dev gulp-htmlmin</div></pre></td></tr></table></figure><p></p><p>另外我并没有压缩合并js，我觉得这是主题应该做的。因为hexo的html和css是hexo生成的，而js是最开始写好就直接移动到<code>public</code>的。我觉得压缩js应该主题做，比如这个<a href="https://github.com/wszgxa/hexo-theme-simple" target="_blank" rel="external">主题</a>。</p><h2 id="添加自动部署命令"><a href="#添加自动部署命令" class="headerlink" title="添加自动部署命令"></a>添加自动部署命令</h2><p>在package.json里面添加如下命令：</p><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">"scripts": &#123;</div><div class="line">  "build": "hexo clean &amp;&amp; hexo g &amp;&amp; gulp &amp;&amp; hexo d"</div><div class="line">&#125;,</div></pre></td></tr></table></figure><p>然后运行<code>npm run build</code>，我们就会自动删除老文件，生成新文件，压缩html、css然后发布到github或其他静态服务器资源。</p></div><div class="read-more"> <a href="/2016/08/19/hexo-compress/"><span class="i-next">阅读全文</span></a></div></div><div class="archives"><div class="title-wrap"><a class="post-title" href="/2014/01/28/hello-hexo/"><h1>Hello Hexo</h1></a><div class="page-info"> <span>By <a href="/about">hiluluke</a> on</span> <time datetime="2014-01-27T16:00:00.000Z" itemprop="datePublished">Jan 28 2014</time></div></div><div class="content-wrap"><p>之前用的是<a href="http://cn.wordpress.org/">wordpress</a>,并搭建在sae里面。不过觉得一点也不好玩。具体和hexo那个好我就不比较了。其实都差不多，各有各自的优点。<br>在<a href="jianshu.io">简书</a>看到的关于在github上搭建博客的教程，了解到hexo。再然后看到jacman这个theme就被吸引了。于是从零开始搭建自己通过hexo在github搭建blog。下面把我搭建学习相关步骤罗列下。<br>我是在网上看的各种教程搭建的，所以会比较多的外链啦~</p><h2 id="熟悉github并配置"><a href="#熟悉github并配置" class="headerlink" title="熟悉github并配置"></a>熟悉github并配置</h2><h3 id="熟悉github"><a href="#熟悉github" class="headerlink" title="熟悉github"></a>熟悉github</h3><p>如果你知道如何使用github就绕过这一节吧。<br>开始我接触<a href="https://github.com/">github</a>的时候全英文，也被唬住了。其实挺简单的。你就按照注册（注册我就不介绍了）后<a href="https://help.github.com/articles/set-up-git">set-up git帮助文档</a><br></p></div><div class="read-more"> <a href="/2014/01/28/hello-hexo/"><span class="i-next">阅读全文</span></a></div></div></section></section><footer class="footer"><div>我是一个粉刷匠</div><div>由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题- <a href="https://github.com/wszgxa/hexo-theme-simple">Simple</a></div></footer></div></div><script src="/js/simple_build.js"></script><script type="text/javascript">var duoshuoQuery={short_name:"hiluluke"};!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https:":"http:")+"//static.duoshuo.com/embed.js",t.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}()</script></body></html>