<!DOCTYPE html><html><head><title> 使用Vue快速开发单页应用 | 主体结构</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta charset="utf-8"><link rel="alternate" href="" title="hilu&#39;s note" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><style>.menu-home .menu-item-home{color:#b71c1c}.menu-categories .menu-item-categories{color:#b71c1c}.menu-tags .menu-item-tags{color:#b71c1c}.menu-about .menu-item-about{color:#b71c1c}.menu-rss .menu-item-rss{color:#b71c1c}</style><link rel="stylesheet" href="/css/style.css"></head><body><script type="text/javascript">!function(){"true"==localStorage.getItem("sidebarState")&&(document.body.className="sideShow")}()</script><div id="container"><aside class="sidebar"><div class="head-icon"> <a href="/about"><img src="/avatar.jpeg"></a></div><div class="name">hiluluke</div><div class="desc"><h4>我是一个粉刷匠</h4></div><nav class="side-nav"><div class="nav-item"> <a href="/"><span>28</span> <span>日志</span></a></div><div class="nav-item"> <a href="/categories"><span>7</span> <span>分类</span></a></div><div class="nav-item"> <a href="/tags"><span>22</span> <span>标签</span></a></div></nav><div class="social-wrap"><a href="https://github.com/wszgxa" target="_blank"><div class="item"><i class="i-github"></i></div></a><a href="http://v2ex.com/member/hiluluke" target="_blank"><div class="item"><i class="i-v2ex"></i></div></a><a href="https://www.zhihu.com/people/zhao-guo-xu" target="_blank"><div class="item"><i class="i-zhihu"></i></div></a><a href="https://twitter.com/Hiluluke" target="_blank"><div class="item"><i class="i-twitter"></i></div></a><a href="http://codepen.io/hiluluke" target="_blank"><div class="item"><i class="i-codepen"></i></div></a></div></aside><div class="wrap"><div class="side"><div class="top" id="back-top"></div><div class="arrows" id="nav-btn"></div></div><header class="header menu-2016"><nav> <a class="menu-item-home" href="/">首页</a> <a class="menu-item-categories" href="/categories">分类</a> <a class="menu-item-tags" href="/tags">标签</a> <a class="menu-item-about" href="/about">关于</a> <a class="menu-item-rss" href="/atom.xml">RSS</a></nav></header><section id="main" class="content"><div class="archives-wrap"><div class="archives"><div class="title-wrap"><h1>使用Vue快速开发单页应用 <small>主体结构</small></h1><div class="page-info"> <span>By <a href="/about">hiluluke</a> on</span> <time datetime="2016-08-03T16:00:00.000Z" itemprop="datePublished">Aug 4 2016</time></div></div><div class="content-wrap"><blockquote><p>本文所涉及代码全在<a href="https://github.com/wszgxa/vue-cnode" target="_blank" rel="external">vue-cnode</a></p></blockquote><p>单页应用，即在一个页面集成系统中所有功能，整个应用只有一个页面。因为路由的控制在前端，单页面应用在页面切换时比传统页面更快，从而在前端体验更好。</p><p>将逻辑从后端转移到前端，提升了性能减少了页面加载时间，前后逻辑更扁平。但是当页面复杂度变高时，你会发现，数据处理，UI交互将变得难以维护，所以应运而生，出现了很多MV<em>框架和类库。Vue就是其中之一，个人觉得（非喜勿喷）Vue类库相对于其他MV</em>框架上整体的api更为简洁，提供的api很平衡，解决了问题的同时，没有增加复杂度。另外个人觉得vue在大型应用，开发中使用vue-loader将组件分成template,style,script结构更为清晰。</p><p>本文以及后面相应文章，主要是vue相关技术栈来快速的实现单页应用开发。系列文章将以一个实际项目进行讲解，项目的github地址为：</p><p><a href="https://github.com/wszgxa/vue-cnode" target="_blank" rel="external">vue-cnode demo</a></p><p>这是一个以<a href="cnodejs.org">cnodejs.org</a>提供的api来开发的单页，主要使用的modules有vue、vue-router、vuex、vue-resource。为了快速开发，我们还使用了vue-cli脚手架工具，下文会做介绍。<br><a id="more"></a></p><h2 id="vue-cli"><a href="#vue-cli" class="headerlink" title="vue-cli"></a>vue-cli</h2><p>自从node的兴起，前端项目中就开始出现各种预处理工具，当我们开始一个新项目时，我们都会先编写一些预处理文件，和构建项目目录。</p><p>而vue-cli就是为了做这方面工作的，生成一套提前定义好的构建文件，和相应的文件。</p><p>vue-cli有5个对应的项目结构。我们使用的是<a href="https://github.com/vuejs-templates/webpack" target="_blank" rel="external">vue-webpack-boilerplate</a>。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ npm install -g vue-cli</div><div class="line">$ vue init webpack my-project</div><div class="line">$ cd my-project</div><div class="line">$ npm install</div><div class="line">$ npm run dev</div></pre></td></tr></table></figure><p>执行上面命令后，我们将生成下面的文件结构，并开一个服务，你可以打开<a href="http://localhost:8080看看。" target="_blank" rel="external">http://localhost:8080看看。</a></p><p><img src="http://7fvhwe.com1.z0.glb.clouddn.com/tree.png" alt="文件结构"></p><p>具体的使用建议看<a href="http://vuejs-templates.github.io/webpack/" target="_blank" rel="external">文档</a>。</p><h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><p>如果你之前就了解vue和vue-router，可以先看这部分。如果你了解vue不了解vue-router,可以先看这篇文章<a href="http://hiluluke.cn/2016/08/05/vue-router/">vue-router</a>。如果你连vue都不是很理解我建议，抽5个小时左右把<a href="http://cn.vuejs.org/guide/" target="_blank" rel="external">文档教程</a>过一遍。</p><p>你可以看到项目根目录下面有一个html，仅有的一个html。</p><p><img src="http://7fvhwe.com1.z0.glb.clouddn.com/fileStruct.png" alt="项目结构"></p><p>上图的结构是我自己琢磨的，主要是结合vue-router、vuex两使用方法来考虑的。另外对于组件的复用，将一些功能组件和全局组件都放在根部，通过vuex来控制组件属性实现一些功能。</p><p>下面我就结构由上至下的介绍。</p><h3 id="main-js"><a href="#main-js" class="headerlink" title="main.js"></a>main.js</h3><p>main.js 是我们的入口文件，主要作用是初始化vue实例并使用需要的插件。<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></div><div class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span></div><div class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">'vue-router'</span></div><div class="line"><span class="keyword">import</span> VueResource <span class="keyword">from</span> <span class="string">'vue-resource'</span></div><div class="line"><span class="keyword">import</span> filter <span class="keyword">from</span> <span class="string">'./filter'</span></div><div class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./vuex/store'</span></div><div class="line"><span class="keyword">import</span> &#123; sync &#125; <span class="keyword">from</span> <span class="string">'vuex-router-sync'</span></div><div class="line"><span class="keyword">import</span> &#123; configRouter &#125; <span class="keyword">from</span> <span class="string">'./config_router'</span></div><div class="line"><span class="keyword">import</span> resourceGlobalSet <span class="keyword">from</span> <span class="string">'./resource_set'</span></div><div class="line"></div><div class="line">Vue.use(VueResource)</div><div class="line">Vue.use(VueRouter)</div><div class="line"><span class="comment">// 初始化自定义过滤器</span></div><div class="line">Vue.use(filter)</div><div class="line"></div><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</div><div class="line">  history: <span class="literal">true</span>,</div><div class="line">  saveScrollPosition: <span class="literal">true</span></div><div class="line">&#125;)</div><div class="line">configRouter(router)</div><div class="line">Vue.http.options.emulateJSON = <span class="literal">true</span></div><div class="line">Vue.http.interceptors.push(resourceGlobalSet) <span class="comment">// ajax 拦截</span></div><div class="line"></div><div class="line">sync(store, router)</div><div class="line">router.start(App, <span class="string">'app'</span>)</div></pre></td></tr></table></figure><p></p><p>就如同上面所示，主要是使用和配置相应插件，并初始化一个vue，上面的初始化在<code>router.start(App, &#39;app&#39;)</code>，是以App.vue为组要组件，并以html中的<app></app>为挂载替换点。</p><h3 id="APP-vue"><a href="#APP-vue" class="headerlink" title="APP.vue"></a>APP.vue</h3><p>App.vue是我们的主组件，所有页面都是在App.vue下进行切换的。其实你也可以理解为所有的路由也是App.vue的子组件。所以我将router标示为App.vue的子组件。</p><p>下面是App.vue的template<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">cn-header</span>&gt;</span><span class="tag">&lt;/<span class="name">cn-header</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">sidebar</span>&gt;</span><span class="tag">&lt;/<span class="name">sidebar</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">tip</span>&gt;</span><span class="tag">&lt;/<span class="name">tip</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">loading</span>&gt;</span><span class="tag">&lt;/<span class="name">loading</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure><p></p><p>你可以看到route-view和其它全局功能组件，全局组件在一个层级。</p><p>另外由于APP.vue在所有页面都有，我们将会在APP.vue上面写一些初始化全局方法。</p><h3 id="router"><a href="#router" class="headerlink" title="router"></a>router</h3><p>router 是具体的业务组件，比如index,login,content等组件都是具体业务相关的。下面就是再和业务相关的组件。</p><h3 id="全局组件"><a href="#全局组件" class="headerlink" title="全局组件"></a>全局组件</h3><p>全局组件是页面共用的部分，比如header，footer，navbar，你可能在想如果我有一些header是独特的怎么办，这种情况下可以通过路由做判断，渲染不同的html，如果判断条件不是路由，也可以在vuex写一个store记录组件的state。</p><h3 id="功能组件"><a href="#功能组件" class="headerlink" title="功能组件"></a>功能组件</h3><p>功能组件是比如dialog,tip等组件，使用来与用户交互的。</p><p>通常情况下，功能组件是各个组件都需要的一些组件。在一个页面里如果有两个组件，两个组件都同时引了一个tip组件作为子组件是纯在的。为了避免这种情况，我们将功能组件提到App.vue然后通过vuex进行组件交互，从而就讲一个功能组件变成了全局方法。</p><h3 id="自定义插件"><a href="#自定义插件" class="headerlink" title="自定义插件"></a>自定义插件</h3><p>vue还能自己写插件。对于一些公用的方法和逻辑，我们可以提出来写在插件里面。</p><h2 id="小节"><a href="#小节" class="headerlink" title="小节"></a>小节</h2><p>可以看到，我们项目整体结构非常清晰。入口加载初始化，主组件挂载路由全局控制，然后全局组件功能组件借助vuex进行数据控制。</p></div></div></div><div class="ds-thread" data-thread-key="2016/08/04/vue-spa/" data-title="使用Vue快速开发单页应用" data-url="http://hiluluke.cn/2016/08/04/vue-spa/"></div></section><footer class="footer"><div>我是一个粉刷匠</div><div>由 <a href="https://hexo.io/">Hexo</a> 强力驱动 | 主题- <a href="https://github.com/wszgxa/hexo-theme-simple">Simple</a></div></footer></div></div><script src="/js/simple_build.js"></script><script type="text/javascript">var duoshuoQuery={short_name:"hiluluke"};!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https:":"http:")+"//static.duoshuo.com/embed.js",t.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}()</script><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-83014983-1","auto"),ga("send","pageview")</script></body></html>